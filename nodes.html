<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <!-- ä¿®å¤çš„ viewport è®¾ç½® -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, minimum-scale=0.5">
    <title>é­”æ³•è¡¥ç»™ç«™ - æé€Ÿè‡ªåŠ¨åŒ–</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=ZCOOL+KuaiLe&display=swap');
        body { background-color: #fff5f7; font-family: 'ZCOOL KuaiLe', cursive; margin: 0; overflow-x: hidden; }
        .glass-card { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px); border: 2px solid #ffb7c5; border-radius: 2.5rem; }
        .sakura-bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 0; }
        
        /* å‘¼å¸ç¯ç‰¹æ•ˆ - ç”¨äºæ™ºèƒ½é«˜äº®æ¨è */
        @keyframes breath {
            0%, 100% { box-shadow: 0 0 5px rgba(255, 107, 129, 0.2); transform: scale(1); }
            50% { box-shadow: 0 0 25px rgba(255, 107, 129, 0.5); transform: scale(1.02); }
        }
        .recommend-active { animation: breath 2s infinite ease-in-out; border: 2px solid #fff; }

        .btn-shadowrocket { background: linear-gradient(135deg, #007aff, #5856d6); }
        .btn-clash { background: linear-gradient(135deg, #fb923c, #ea580c); }
        .btn-clash-backup { background: linear-gradient(135deg, #4ade80, #16a34a); }
        
        /* ç§»åŠ¨ç«¯ä¿®å¤ */
        @media (max-width: 768px) {
            body {
                padding: 10px;
                touch-action: pan-y pinch-zoom;
            }
            
            .glass-card {
                border-radius: 2rem;
                padding: 1.5rem !important;
            }
            
            h2 {
                font-size: 1.5rem !important;
            }
            
            button {
                padding: 1rem !important;
                font-size: 0.9rem !important;
            }
            
            /* é˜²æ­¢é¡µé¢è¿‡å¤§ */
            .max-w-md {
                max-width: 100% !important;
            }
        }
        
        /* iOS å®‰å…¨åŒºåŸŸæ”¯æŒ */
        @supports (-webkit-touch-callout: none) {
            body {
                padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
            }
        }
    </style>
</head>
<body class="p-4 min-h-screen flex items-center justify-center">
    <canvas id="sakura-canvas" class="sakura-bg"></canvas>

    <div class="max-w-md w-full mx-auto relative z-10">
        <div class="glass-card p-8 shadow-2xl text-center">
            <div class="w-20 h-20 rounded-full border-4 border-white shadow-lg overflow-hidden mx-auto mb-4">
                <img src="tx.jpg" class="w-full h-full object-cover" alt="Avatar">
            </div>

            <h2 class="text-2xl font-bold text-[#ff6b81] mb-1">âœ¨ é­”æ³•è¡¥ç»™ç«™</h2>
            
            <div class="flex justify-center gap-2 mb-6 mt-2">
                <span id="node-count" class="bg-pink-100 text-[#ff6b81] text-[10px] px-2 py-1 rounded-full border border-pink-200">ğŸ“Š æ­£åœ¨è¡¥ç»™...</span>
                <span id="update-time" class="bg-blue-100 text-blue-500 text-[10px] px-2 py-1 rounded-full border border-blue-200">ğŸŒ¸ è‡ªåŠ¨æ›´æ–°</span>
            </div>
            
            <div class="space-y-4">
                <button id="btn-ios" onclick="importShadowrocket()" class="block w-full btn-shadowrocket text-white font-bold py-4 rounded-2xl shadow-lg transition-all active:scale-95 flex flex-col items-center">
                    <span>ğŸš€ ä¸€é”®å¯¼å…¥å°ç«ç®­ (iOS)</span>
                    <span class="text-[9px] opacity-80 font-normal">æ”¯æŒ Shadowrocket / Quantumult X</span>
                </button>

                <button id="btn-android" onclick="importClash('fast')" class="block w-full btn-clash text-white font-bold py-4 rounded-2xl shadow-lg transition-all active:scale-95 flex flex-col items-center">
                    <span>ğŸ”¥ ä¸€é”®å¯¼å…¥ Clash (æé€Ÿç§’æ¨)</span>
                    <span class="text-[9px] opacity-80 font-normal">æ¨èå®‰å“/Windowsç”¨æˆ·ä½¿ç”¨</span>
                </button>

                <button onclick="importClash('convert')" class="block w-full btn-clash-backup text-white font-bold py-4 rounded-2xl shadow-lg transition-all active:scale-95 text-sm">
                    ğŸ”„ å¯¼å…¥å¤±è´¥è¯·ç‚¹æ­¤ (å¤‡ç”¨çº¿è·¯)
                </button>

                <button onclick="copyLink()" id="copyBtn" class="block w-full bg-white text-[#ff8fa3] font-bold py-4 rounded-2xl border-2 border-[#ffb7c5] transition-all text-sm">
                    ğŸ“‹ ä»…å¤åˆ¶è®¢é˜…é“¾æ¥
                </button>
            </div>
            
            <div class="mt-8 px-4 text-center border-t border-dashed border-pink-100 pt-6">
                <p class="text-[11px] text-gray-400 italic">ğŸŸ¢ å½“å‰æœåŠ¡å™¨çŠ¶æ€ï¼šè‰¯å¥½ (CDNå·²åŠ é€Ÿ)</p>
                <p class="mt-4 text-[10px] text-gray-300">Â© 2025 é£çš„é­”æ³•å°å±‹ | è‡ªåŠ¨è¡¥è´§ç³»ç»Ÿ</p>
            </div>
        </div>
    </div>

    <script>
        const GITHUB_USER = "feng-180";
        const GITHUB_REPO = "feng-180.github.io";
        const JS_DELIVR = `https://fastly.jsdelivr.net/gh/${GITHUB_USER}/${GITHUB_REPO}@main/sub_all.txt`;

        // ç®€åŒ–çŠ¶æ€æ˜¾ç¤ºï¼Œé¿å…ç½‘ç»œé—®é¢˜å¯¼è‡´çš„"è·å–å¤±è´¥"
        async function fetchStatus() {
            try {
                const response = await fetch(JS_DELIVR);
                const text = await response.text();
                // ç®€åŒ–ç»Ÿè®¡é€»è¾‘ï¼Œé¿å…å¤æ‚åŒ¹é…å¤±è´¥
                const lines = text.split('\n').filter(line => line.includes('://')).length;
                document.getElementById('node-count').innerHTML = `ğŸ“Š å½“å‰è¡¥ç»™: ${lines} èŠ‚ç‚¹`;
                
                // ä½¿ç”¨æœ¬åœ°æ—¶é—´ï¼Œé¿å…GitHub APIé™åˆ¶
                const now = new Date();
                const hours = now.getHours().toString().padStart(2, '0');
                const minutes = now.getMinutes().toString().padStart(2, '0');
                document.getElementById('update-time').innerHTML = `ğŸ•’ ${hours}:${minutes} å·²è¡¥è´§`;
            } catch (e) {
                // å¦‚æœå¤±è´¥ï¼Œæ˜¾ç¤ºå‹å¥½æç¤º
                document.getElementById('node-count').innerHTML = "ğŸ“Š è¡¥ç»™ç«™è¿æ¥ä¸­";
                document.getElementById('update-time').innerHTML = "ğŸŒ¸ è‡ªåŠ¨æ›´æ–°";
            }
        }

        // æ™ºèƒ½è®¾å¤‡é«˜äº®
        function autoHighlight() {
            const ua = navigator.userAgent.toLowerCase();
            if (/iphone|ipad|ipod/.test(ua)) {
                document.getElementById('btn-ios').classList.add('recommend-active');
            } else if (/android/.test(ua)) {
                document.getElementById('btn-android').classList.add('recommend-active');
            }
        }

        function importShadowrocket() {
            try {
                // ä¿®å¤Base64ç¼–ç é—®é¢˜
                const encodedUrl = btoa(unescape(encodeURIComponent(JS_DELIVR)));
                window.location.href = "shadowrocket://add/sub://" + encodedUrl + "?remark=é­”æ³•è¡¥ç»™ç«™";
                setTimeout(() => { 
                    alert('ğŸŒ¸ é­”æ³•èƒ½é‡ä¼ è¾“ä¸­...\n\nå¦‚æœæœªè‡ªåŠ¨è·³è½¬ï¼Œè¯·æ£€æŸ¥æ˜¯å¦å·²å®‰è£…å°ç«ç®­ã€‚'); 
                }, 1000);
            } catch (e) {
                alert('å¯¼å…¥å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶é“¾æ¥');
                copyLink();
            }
        }

        function importClash(mode) {
            let finalUrl = (mode === 'fast') 
                ? `${JS_DELIVR}?t=${new Date().getTime()}`
                : `https://sub.id9.cc/sub?target=clash&url=${encodeURIComponent(JS_DELIVR)}&new_name=Magic_Station`;
            
            window.location.href = "clash://install-config?url=" + encodeURIComponent(finalUrl);
            setTimeout(() => { 
                alert('ğŸŒ¸ é­”æ³•èƒ½é‡ä¼ è¾“ä¸­...\n\nå¦‚æœæœªè‡ªåŠ¨è·³è½¬ï¼Œè¯·æ£€æŸ¥æ˜¯å¦å·²å®‰è£…Clashã€‚'); 
            }, 1000);
        }

        function copyLink() {
            navigator.clipboard.writeText(JS_DELIVR).then(() => {
                const btn = document.getElementById('copyBtn');
                btn.innerHTML = "âœ… å¤åˆ¶æˆåŠŸ (åŠ é€Ÿé“¾æ¥)";
                btn.classList.add('bg-green-50', 'text-green-600', 'border-green-200');
                setTimeout(() => { 
                    btn.innerHTML = "ğŸ“‹ ä»…å¤åˆ¶è®¢é˜…é“¾æ¥";
                    btn.classList.remove('bg-green-50', 'text-green-600', 'border-green-200');
                }, 2000);
            }).catch(() => {
                // å¦‚æœå¤åˆ¶å¤±è´¥ï¼Œæ˜¾ç¤ºé“¾æ¥è®©ç”¨æˆ·æ‰‹åŠ¨å¤åˆ¶
                alert('è¯·æ‰‹åŠ¨å¤åˆ¶é“¾æ¥ï¼š\n\n' + JS_DELIVR);
            });
        }

        // åˆå§‹åŒ–
        window.onload = () => { fetchStatus(); autoHighlight(); };

        // æ¨±èŠ±åŠ¨æ•ˆ (ä¿æŒåŸæ ·)
        const canvas = document.getElementById('sakura-canvas');
        const ctx = canvas.getContext('2d');
        let sakuraArray = [];
        function resize() { 
            canvas.width = window.innerWidth; 
            canvas.height = window.innerHeight; 
        }
        class Sakura {
            constructor() {
                this.x = Math.random() * canvas.width;
                this.y = Math.random() * canvas.height - canvas.height;
                this.size = Math.random() * 7 + 3;
                this.speedX = Math.random() * 1.5 - 0.5;
                this.speedY = Math.random() * 1 + 1;
                this.angle = Math.random() * 360;
                this.spin = Math.random() * 2 - 1;
            }
            draw() {
                ctx.save(); 
                ctx.translate(this.x, this.y); 
                ctx.rotate(this.angle * Math.PI / 180);
                ctx.fillStyle = '#ffb7c5'; 
                ctx.beginPath();
                ctx.ellipse(0, 0, this.size, this.size/2, 0, 0, Math.PI * 2); 
                ctx.fill(); 
                ctx.restore();
            }
            update() {
                this.x += this.speedX; 
                this.y += this.speedY; 
                this.angle += this.spin;
                if (this.y > canvas.height) { 
                    this.y = -20; 
                    this.x = Math.random() * canvas.width; 
                }
            }
        }
        function init() { 
            resize(); 
            for (let i = 0; i < 20; i++) sakuraArray.push(new Sakura()); 
        }
        function animate() { 
            ctx.clearRect(0, 0, canvas.width, canvas.height); 
            sakuraArray.forEach(s => { s.update(); s.draw(); }); 
            requestAnimationFrame(animate); 
        }
        window.addEventListener('resize', resize); 
        init(); 
        animate();
    </script>
</body>
</html>